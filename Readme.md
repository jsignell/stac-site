# Stac Website

## Getting Started

### Prereqs
- [Node & NPM](https://nodejs.org/en/) 
    - Recommended [mac installation with homebrew & nvm](https://formulae.brew.sh/formula/nvm)
    - Recommended pc installation with [chocolatey & nvm](https://community.chocolatey.org/packages/nvm)
    - [nvm documentation](https://github.com/nvm-sh/nvm#readme)
- [Docker](https://www.docker.com/products/docker-desktop/) (If adding Jupyter Notebooks)

### Installation

```
npm install
npm run serve
```

If this step results in errors, I recommend using node version `17.8.0`, the current stable version at the time of writing.

## Creating Tutorials

New tutorials are created in markdown format and added in to the [app/tutorials] directory.

Tutorials are categorized by adding them to a directory in the tutorials folder.

Tutorials should be in their own directory along with any translated versions of the tutorial.

Heres an example:

```
app/
    tutorials/                           # this is the tutorials root
        getting-started/                 # this is the category
            stac-collections/            # this is the tutorial
                stac-collections.en.md   # this is an english version
                stac-colecciones.es.md   # this is a spanish version
```

The url paths are autogenerated, for the tutorials shown above they would be:

```
/en/tutorials/stac-collections
`/es/tutorials/stac-collecciones
```

### Tutorial Frontmatter Requirements

You'll need to add a few properties in `yml` format to the markdown frontmatter at the very top of your file. Here's an example:

```
---
title: A title for your tutorial, this is used for SEO and in previews throughout the site
description: A short description of the tutorial. This will be used in the meta description and in tutorial previews throughout the site.
notebooks: ['name-of-notebook-file-no-extension']
---
```

the notebooks property is optional, and will add a notebook from the [notebooks/build](./notebooks/build) directory below any markdown content you add to the tutorial.

### Compiling Notebooks

Add notebooks to the [notebooks/src](./notebooks/src) directory

Notebooks can be built via [python 3.9](https://github.com/docker-library/python/blob/e3f954f284ab822e939d99bddb3bfb25574f585e/3.9/slim-bullseye/Dockerfile) with the included docker-compose config by running:

```
docker-compose up
```

Docker is the more consistent way to compile the notebooks, but you may also run the bash build script directly if you have python 3.x installed on your machine:

```
cd notebooks
pip3 install -r requirements.txt
sh build_notebooks
```

## Pages

Pages are written using the [Nunjucks templating language](https://mozilla.github.io/nunjucks/).

### Page Frontmatter Requirements

You'll need to add a few properties in `yml` format to the markdown frontmatter at the very top of your file. Here's an example:

```
---
title: A title for your page, this is used for SEO and in previews throughout the site
description: A short description of the page. This will be used in the meta description and in tutorial previews throughout the site.
route:
    en: /en/example-url-for/english-translation
    es: /es/url-ejemplo-para/traduccion-en-espanol
name: example.correlates.toAContentFile
---
```

### Page Content

All page content is added to the [content](content) directory.

The page `name` property should correlate to the content path. For example `name: about.stacSpec` correlates to the [content/about/stac-spec.js](content/about/stac-spec.js) file. This works because the file is exported from the file and imported into the [content/about/index.js](content/about/index.js) file, which is then imported into the larger content object at [content/index.js](content/index.js).

To reference the content from the correlated content file in the template files, you can use the filter `localize`, like so:

```
{{ .hero.cta_text | localize }}
```

with the first `.` in `.hero` referencing that the content should be scoped to that correlated file, rather than the content root.

All content is saved in a format that the [Eleventy i18n plugin](https://www.npmjs.com/package/eleventy-plugin-i18n) recommends. The final property in the tree should correlate to a locale code, for example:

```
hero: {
    cta_text: {
        'en': 'Click',
        'es': 'Hacer clic'
    }
}
```

If this all seems complicated, this is why CMS's are a popular option. If in the future this becomes too much to manage in the filesystem, eleventy can generate content from API calls as well. An example of this can be found in [app/_data/catalogs.js](app/_data/catalogs.js)

## Deployment & CI

Coming soon.

## Architecture

- [Node.js](https://nodejs.org/en/) is the base technology that the site is built on
- Site uses the [11ty static site generator](https://www.11ty.dev/) to compile all the site files into a static website build.
- Templating is in the [Nunjucks templating language](https://mozilla.github.io/nunjucks/)
- [Docker](https://www.docker.com/products/docker-desktop/) is used to build notebooks
- [Tailwind CSS](https://tailwindcss.com/docs/overflow) is used to reduce the amount of custom css without compromising custom look and feel
- [Alpine JS](https://alpinejs.dev/) is used to create interactive components